<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <title>BEDOX – Fix &amp; Flip Rechner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-100">
    <div class="relative min-h-screen px-3 py-4 sm:px-4 sm:py-6">
      <div
        class="mx-auto flex max-w-6xl flex-col gap-6 lg:flex-row"
        id="app-root"
      >
        <!-- Input-Bereich -->
        <div class="w-full space-y-4 lg:w-1/2">
          <h1 class="text-xl font-semibold text-slate-900">
            BEDOX – Fix &amp; Flip Rechner
          </h1>
          <p class="text-xs text-slate-500">
            Passe die Werte links an – rechts siehst du sofort, ob der Deal
            sich lohnt (vor Steuern).
          </p>

          <!-- Block: Einkauf & Sanierung -->
          <div class="rounded-2xl bg-white p-4 shadow-sm">
            <h2 class="mb-3 text-sm font-semibold text-slate-800">
              1. Einkauf &amp; Sanierung
            </h2>
            <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
              <!-- Kaufpreis -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Kaufpreis
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="purchasePrice"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="250000"
                    step="1000"
                  />
                  <span class="ml-1 text-xs text-slate-500">€</span>
                </div>
              </label>

              <!-- Kaufnebenkosten -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Kaufnebenkosten
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="purchaseCostsPercent"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="10"
                    step="0.5"
                  />
                  <span class="ml-1 text-xs text-slate-500">
                    % vom Kaufpreis
                  </span>
                </div>
              </label>

              <!-- Sanierungskosten -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Sanierungskosten
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="renovationCosts"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="60000"
                    step="1000"
                  />
                  <span class="ml-1 text-xs text-slate-500">€</span>
                </div>
              </label>

              <!-- Sonstige Kosten -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Sonstige Kosten (z. B. Gutachten)
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="otherCosts"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="5000"
                    step="500"
                  />
                  <span class="ml-1 text-xs text-slate-500">€</span>
                </div>
              </label>
            </div>
          </div>

          <!-- Block: Finanzierung & Haltedauer -->
          <div class="rounded-2xl bg-white p-4 shadow-sm">
            <h2 class="mb-3 text-sm font-semibold text-slate-800">
              2. Finanzierung &amp; Haltedauer
            </h2>
            <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
              <!-- Fremdkapitalanteil -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Fremdkapitalanteil
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="financingSharePercent"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="80"
                    step="5"
                  />
                  <span class="ml-1 text-xs text-slate-500">
                    % der Gesamtkosten
                  </span>
                </div>
              </label>

              <!-- Zinssatz p. a. -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Zinssatz p. a.
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="interestRateAnnual"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="6"
                    step="0.25"
                  />
                  <span class="ml-1 text-xs text-slate-500">%</span>
                </div>
              </label>

              <!-- Haltezeit -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Haltezeit
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="holdingMonths"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="9"
                    step="1"
                  />
                  <span class="ml-1 text-xs text-slate-500">Monate</span>
                </div>
              </label>
            </div>
          </div>

          <!-- Block: Verkauf -->
          <div class="rounded-2xl bg-white p-4 shadow-sm">
            <h2 class="mb-3 text-sm font-semibold text-slate-800">
              3. Verkauf
            </h2>
            <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
              <!-- Verkaufspreis -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Verkaufspreis
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="salesPrice"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="420000"
                    step="1000"
                  />
                  <span class="ml-1 text-xs text-slate-500">€</span>
                </div>
              </label>

              <!-- Verkaufskosten -->
              <label class="flex flex-col gap-1 text-sm">
                <span class="text-xs font-medium text-slate-500">
                  Verkaufskosten (Makler, Notar etc.)
                </span>
                <div
                  class="flex items-center rounded-2xl border border-slate-300 bg-slate-50 px-3 py-2 text-sm shadow-sm"
                >
                  <input
                    id="sellingCostsPercent"
                    type="number"
                    class="flex-1 bg-transparent outline-none"
                    value="4"
                    step="0.5"
                  />
                  <span class="ml-1 text-xs text-slate-500">
                    % vom Verkaufspreis
                  </span>
                </div>
              </label>
            </div>
          </div>
        </div>

        <!-- Ergebnis-Bereich -->
        <div class="w-full lg:w-1/2">
          <div class="lg:sticky lg:top-4 space-y-4">
            <!-- Zusammenfassung -->
            <div class="rounded-2xl bg-slate-900 p-4 text-slate-50 shadow-md">
              <h2
                class="mb-2 text-sm font-semibold tracking-wide text-slate-200"
              >
                Deal-Zusammenfassung
              </h2>
              <div class="mb-2 flex items-baseline justify-between">
                <span
                  class="text-xs uppercase tracking-wide text-slate-400"
                >
                  Erwarteter Gewinn (vor Steuern)
                </span>
                <span
                  id="profitMain"
                  class="text-lg font-semibold text-slate-700"
                >
                  –
                </span>
              </div>
              <div class="grid grid-cols-2 gap-2 text-xs">
                <div class="rounded-xl bg-slate-800/80 p-2">
                  <div class="text-slate-400">Eigenkapital-Rendite</div>
                  <div
                    id="roiMain"
                    class="text-sm font-semibold text-slate-50"
                  >
                    –
                  </div>
                </div>
                <div class="rounded-xl bg-slate-800/80 p-2">
                  <div class="text-slate-400">Annualisierte Rendite</div>
                  <div
                    id="annualizedRoiMain"
                    class="text-sm font-semibold text-slate-50"
                  >
                    –
                  </div>
                </div>
                <div class="rounded-xl bg-slate-800/80 p-2">
                  <div class="text-slate-400">
                    Marge auf Verkaufspreis
                  </div>
                  <div
                    id="marginOnSalesMain"
                    class="text-sm font-semibold text-slate-50"
                  >
                    –
                  </div>
                </div>
                <div class="rounded-xl bg-slate-800/80 p-2">
                  <div class="text-slate-400">Haltezeit</div>
                  <div
                    id="holdingMonthsMain"
                    class="text-sm font-semibold text-slate-50"
                  >
                    –
                  </div>
                </div>
              </div>
            </div>

            <!-- Detail-Boxen -->
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
              <!-- Investition & Finanzierung -->
              <div class="rounded-2xl bg-white p-4 shadow-sm">
                <h3
                  class="mb-3 text-xs font-semibold uppercase tracking-wide text-slate-500"
                >
                  Investition &amp; Finanzierung
                </h3>
                <div class="space-y-1.5 text-sm">
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">Kaufnebenkosten</span>
                    <span
                      id="purchaseCostsDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">
                      Gesamtkosten vor Zinsen
                    </span>
                    <span
                      id="totalCostsBeforeInterestDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">Fremdkapital</span>
                    <span
                      id="financedAmountDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">
                      Eigenkapital-Einsatz
                    </span>
                    <span
                      id="equityDisplay"
                      class="font-semibold text-slate-900"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">
                      Zinskosten (Haltezeit)
                    </span>
                    <span
                      id="interestCostsDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                </div>
              </div>

              <!-- Verkauf & Ergebnis -->
              <div class="rounded-2xl bg-white p-4 shadow-sm">
                <h3
                  class="mb-3 text-xs font-semibold uppercase tracking-wide text-slate-500"
                >
                  Verkauf &amp; Ergebnis
                </h3>
                <div class="space-y-1.5 text-sm">
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">Verkaufspreis</span>
                    <span
                      id="salesPriceDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">Verkaufskosten</span>
                    <span
                      id="sellingCostsDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">
                      Gesamtkosten inkl. Zins &amp; Verkauf
                    </span>
                    <span
                      id="totalCostsDisplay"
                      class="font-medium text-slate-700"
                      >–</span
                    >
                  </div>
                  <div class="flex items-baseline justify-between">
                    <span class="text-slate-500">
                      Gewinn (vor Steuern)
                    </span>
                    <span
                      id="profitDisplay"
                      class="font-semibold text-slate-900"
                      >–</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- Hinweis -->
            <div
              class="rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-3 text-xs text-slate-500"
            >
              <p class="font-semibold text-slate-700">
                Hinweis (Prototyp)
              </p>
              <ul class="mt-1 list-disc space-y-1 pl-4">
                <li>
                  Alle Werte sind vor Steuern und ohne
                  Spekulationsfrist-Regelungen.
                </li>
                <li>
                  Du kannst später weitere Kostenblöcke ergänzen
                  (Steuern, Notar beim Verkauf, Sonderfälle).
                </li>
                <li>
                  Logik &amp; Felder können wir gemeinsam an deine
                  Fix-&amp;-Flip-Strategie anpassen.
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- BEDOX Logo unten rechts mit Streifen -->
      <div
        class="pointer-events-none select-none fixed bottom-4 right-3 sm:bottom-6 sm:right-6"
      >
        <div class="flex items-center gap-2 sm:gap-3">
          <!-- Linke Streifen -->
          <div class="flex flex-col gap-1">
            <div
              class="h-[3px] w-12 sm:w-16 bg-gradient-to-r from-slate-900 to-slate-400"
            ></div>
            <div
              class="h-[3px] w-12 sm:w-16 bg-gradient-to-r from-slate-900 to-slate-400"
            ></div>
          </div>

          <!-- BEDOX Schriftzug -->
          <span
            class="bg-gradient-to-b from-slate-900 to-slate-400 bg-clip-text text-3xl sm:text-5xl font-extrabold tracking-[0.35em]"
          >
            BEDOX
          </span>

          <!-- Rechte Streifen -->
          <div class="flex flex-col gap-1">
            <div
              class="h-[3px] w-12 sm:w-16 bg-gradient-to-l from-slate-900 to-slate-400"
            ></div>
            <div
              class="h-[3px] w-12 sm:w-16 bg-gradient-to-l from-slate-900 to-slate-400"
            ></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function parseNumber(value) {
        const n = parseFloat(String(value).replace(",", "."));
        return isNaN(n) ? 0 : n;
      }

      const currencyFormatter = new Intl.NumberFormat("de-DE", {
        style: "currency",
        currency: "EUR",
        maximumFractionDigits: 0,
      });

      function formatCurrency(v) {
        return currencyFormatter.format(isFinite(v) ? v : 0);
      }

      function formatPercent(v) {
        const val = isFinite(v) ? v * 100 : 0;
        return val.toFixed(1) + " %";
      }

      function recalc() {
        const pPrice = parseNumber(
          document.getElementById("purchasePrice").value
        );
        const pCostPct =
          parseNumber(
            document.getElementById("purchaseCostsPercent").value
          ) / 100;
        const reno = parseNumber(
          document.getElementById("renovationCosts").value
        );
        const other = parseNumber(
          document.getElementById("otherCosts").value
        );
        const finShare =
          parseNumber(
            document.getElementById("financingSharePercent").value
          ) / 100;
        const rate =
          parseNumber(
            document.getElementById("interestRateAnnual").value
          ) / 100;
        const months = parseNumber(
          document.getElementById("holdingMonths").value
        );
        const sPrice = parseNumber(
          document.getElementById("salesPrice").value
        );
        const sellCostPct =
          parseNumber(
            document.getElementById("sellingCostsPercent").value
          ) / 100;

        const purchaseCosts = pPrice * pCostPct;
        const totalCostsBeforeInterest =
          pPrice + purchaseCosts + reno + other;

        const financedAmount = totalCostsBeforeInterest * finShare;
        const equity = totalCostsBeforeInterest - financedAmount;

        const interestCosts = financedAmount * rate * (months / 12);
        const sellingCosts = sPrice * sellCostPct;

        const totalCosts =
          totalCostsBeforeInterest + interestCosts + sellingCosts;
        const profit = sPrice - totalCosts;

        const roi = equity > 0 ? profit / equity : 0;
        const annualizedRoi =
          months > 0 ? Math.pow(1 + roi, 12 / months) - 1 : 0;
        const marginOnSales = sPrice > 0 ? profit / sPrice : 0;

        // Zusammenfassung
        const profitMain = document.getElementById("profitMain");
        profitMain.textContent = formatCurrency(profit);
        profitMain.className =
          "text-lg font-semibold " +
          (profit > 0
            ? "text-emerald-400 sm:text-emerald-500"
            : profit < 0
            ? "text-rose-400 sm:text-rose-500"
            : "text-slate-200");

        document.getElementById("roiMain").textContent =
          formatPercent(roi);
        document.getElementById(
          "annualizedRoiMain"
        ).textContent = formatPercent(annualizedRoi);
        document.getElementById(
          "marginOnSalesMain"
        ).textContent = formatPercent(marginOnSales);
        document.getElementById("holdingMonthsMain").textContent =
          months.toFixed(0) + " Monate";

        // Detailboxen
        document.getElementById(
          "purchaseCostsDisplay"
        ).textContent = formatCurrency(purchaseCosts);
        document.getElementById(
          "totalCostsBeforeInterestDisplay"
        ).textContent = formatCurrency(totalCostsBeforeInterest);
        document.getElementById(
          "financedAmountDisplay"
        ).textContent = formatCurrency(financedAmount);
        document.getElementById(
          "equityDisplay"
        ).textContent = formatCurrency(equity);
        document.getElementById(
          "interestCostsDisplay"
        ).textContent = formatCurrency(interestCosts);

        document.getElementById(
          "salesPriceDisplay"
        ).textContent = formatCurrency(sPrice);
        document.getElementById(
          "sellingCostsDisplay"
        ).textContent = formatCurrency(sellingCosts);
        document.getElementById(
          "totalCostsDisplay"
        ).textContent = formatCurrency(totalCosts);
        document.getElementById(
          "profitDisplay"
        ).textContent = formatCurrency(profit);
      }

      function attachListeners() {
        const ids = [
          "purchasePrice",
          "purchaseCostsPercent",
          "renovationCosts",
          "otherCosts",
          "financingSharePercent",
          "interestRateAnnual",
          "holdingMonths",
          "salesPrice",
          "sellingCostsPercent",
        ];
        ids.forEach((id) => {
          const el = document.getElementById(id);
          if (el) {
            el.addEventListener("input", recalc);
          }
        });
        recalc();
      }

      document.addEventListener("DOMContentLoaded", attachListeners);
    </script>
  </body>
</html>
